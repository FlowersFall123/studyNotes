# **网页部署**

## *一、准备*

1.首先需要一个**服务器**（**不建议使用国内的**，因为要备案）

2.域名购买（也可以不买）

3.在**宝塔面板**中安装一下内容
![](https://www.fzpersonalweb.xyz/api/uploads/ef94d39e-71e3-4868-b27c-48a3264e6b5f_image-20241009211302312.png)





## **二、前端**

### **1.代码处理**

在前端的`main.js`文件中写入以下语句，不改的话手机端登陆不了

```js
axios.defaults.baseURL = 'https://域名或者服务器IP地址'
// axios.defaults.baseURL = 'http://localhost:8080'
```

在前端的终端中运行

```
npm run build
```

编译完成
![](https://www.fzpersonalweb.xyz/api/uploads/4355cab8-8868-4875-b876-c3dcb25a6fe1_image-20241009212912747.png)




会多出来一个文件夹
![](https://www.fzpersonalweb.xyz/api/uploads/c47fad4f-1e0f-4a24-b56a-7bf142095c1e_image-20241009213005390.png)



将前端代码上传到宝塔面板
![](https://www.fzpersonalweb.xyz/api/uploads/6072a1a5-c589-4376-935c-1e6a03fe6478_image-20241009213218229.png)





### 2.创建站点+申请证书
![](https://www.fzpersonalweb.xyz/api/uploads/629eaa6a-27ad-46dd-ab07-78cc38ef91e1_image-20241009214522362.png)
![](https://www.fzpersonalweb.xyz/api/uploads/8bcf1f21-2ad0-4f4c-a5a0-d0a505ea4b92_image-20241009214630532.png)
![](https://www.fzpersonalweb.xyz/api/uploads/25d60df2-a8fb-494a-8799-cccdc5150113_image-20241009214722142.png)


### **3.处理刷新问题**

在**配置文件**中添加以下代码

```
location / {
            try_files $uri $uri/ @router;
    #需要指向下面的@router否则会出现vue的路由在nginx中刷新出现404
            index  index.html index.htm;
        }
	#对应上面的@router，主要原因是路由的路径资源并不是一个真实的路径，所以无法找到具体的文件
    #因此需要rewrite到index.html中，然后交给路由在处理请求资源
        location @router {
            rewrite ^.*$ /index.html last;
        }
```
![](https://www.fzpersonalweb.xyz/api/uploads/6ed74d98-8630-497e-b2f8-d89d4fe2ff70_image-20241009215813427.png)







## **三、后端**

### 1.数据库的上传

先将数据库导出
![](https://www.fzpersonalweb.xyz/api/uploads/5d42c6fe-2bcd-477a-bfb2-e2e32956b3ef_image-20241009213807776.png)



### 2.导入报错处理

可能需要**修改编码**(报错的话，电脑为mysql 8.0   服务器mysql 5.7    高版本向低版本导入会出错)，可以使用`vs code`

```css
将sql文件中的所有：utf8mb4_0900_ai_ci替换为utf8_general_ci，utf8mb4替换为utf8保存后再次运行sql文件
```

### 3.代码修改
![](https://www.fzpersonalweb.xyz/api/uploads/21b36a0a-1bb5-4393-ae48-b9b0d388a3f9_image-20241009220541038.png)





```yaml
//application.yml
spring:
  profiles:
    active: dev
```

```yml
//application-dev.yml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/数据库名
    #jdbc????? ????jdbc:mysql://????????:??/????
    username: root
    #?????
    password: 19805601056Bkj@@
    #?????
    driver-class-name: com.mysql.cj.jdbc.Driver
    #??????

#???MySQL????????????????????
```

```yml
//application-pro.yml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/数据库名（宝塔上面的）
    #jdbc????? ????jdbc:mysql://????????:??/????
    username: 数据库的用户名（宝塔上面的）
    #?????
    password: 数据库的密码（宝塔上面的）
    #?????
    driver-class-name: com.mysql.cj.jdbc.Driver
    #??????

#???MySQL????????????????????
```

### 4.打包
![](https://www.fzpersonalweb.xyz/api/uploads/7161feb6-31c2-45b4-8bcf-3d21138da051_image-20241010140103910.png)
![](https://www.fzpersonalweb.xyz/api/uploads/cc94a749-a167-497d-bcfe-4dc82005f840_image-20241010140202904.png)



### 5.文件上传
![](https://www.fzpersonalweb.xyz/api/uploads/4a4074a8-bf7d-49fd-b0cf-e86f6ebe26fa_image-20241010140328978.png)
![](https://www.fzpersonalweb.xyz/api/uploads/4a45dd8f-2e08-4d20-a1d3-3cfeee2cfc4b_image-20241010140522984.png)




### 6.统一前后端域名

在以下界面中添加代码



```css
location /api {
	proxy_pass http://localhost:8080;
}
```
![](https://www.fzpersonalweb.xyz/api/uploads/d6e6c292-037a-4def-9fdd-7e070f4ac760_image-20241010141246718.png)

因为这里有一个`api`
![](https://www.fzpersonalweb.xyz/api/uploads/bb98dac8-4d28-4080-be3a-c9aaf708a80c_image-20241010144440573.png)